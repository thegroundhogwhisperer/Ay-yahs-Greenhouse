# Ay-yahs-Greenhouse


# Python scripts for receiving and resending RTTY and SSTV data via email


# greenhousesendrttyemail.py


# Requirements: 


Fldigi - digital modem program for hamradio operators

Python 3


# 
# Produces:


# Email messages containing RTTY data received via a radio tranmissions


This script monitors the /talk/textout.txt file produced by Fldigi for RTTY transmissions generated by greenhousestatusttsrttysstvrf.py  This script parses the received RTTY transmission data for a call sign and a time stamp (Unix epoch) included in the transmission.  When a valid transmission is received the RTTY data is sent via email using a secure SMTP connection. (e.g. GMail SMTP)  The time stamp is recorded for future comparison to incoming time stamp values to differentiate between rebroadcast tranmssions and updated tranmssions.

# greenhousesendrttyemailalarm.py


# Requirements: 


Fldigi - digital modem program for hamradio operators

Python 3


# 
# Produces:


# Email messages containing RTTY data received via a radio tranmissions


This script monitors the /talk/textout.txt file produced by Fldigi for RTTY transmissions generated by greenhousestatusttsrttysstvrf.py  This script parses the received RTTY transmission data for a call sign and a time stamp (Unix epoch) included in the transmission.  When a valid transmission is received containing specific values (e.g. soil moisture > n, temperature > n, temperature < n) an alarm notice is sent via email using a secure SMTP connection. (e.g. GMail SMTP)  The time stamp is recorded for future comparison to incoming time stamp values to differentiate between rebroadcast tranmssions and updated tranmssions.


# 
# greenhousesendsstvemail.py



# Requirements: 


QSSTV - Qt based slow scan television and fax

Python 3


# 
# Produces:


# Email messages containing SSTV image data received via a radio tranmissions


This script monitors a folder for .png image files produced by QSSTV transmissions generated by greenhousestatusttsrttysstvrf.py  This script locates the most recently created image file in the folder and sends the image as an email message attachment.  The most recent image file name sent via email is recorded for future comparison to prevent retranmission of the same SSTV image file.



# 
# Python script for uploading RTTY and SSTV data to a Dropbox account



# dropboxbackuprttysstv.py


# 
# Produces:



Text file and image file uploads to a Dropbox account



dropboxbackuprttysstv.py is a script that uploads Fldigi textout.txt files to
a Dropbox account only after the file is N number of seconds older than the last copy uploaded.
dropboxbackuprttysstv.py also locates and uploads the most recently saved SSTV image
file to a Dropbox account.


# 
# Requirements:


Dropbox - file hosting service account - application access token

QSSTV - Qt based slow scan television and fax

Fldigi - digital modem program for hamradio operators

Python 3

Reference

https://github.com/dropbox/dropbox-sdk-python/blob/master/example/back-up-and-restore/backup-and-restore-example.py

https://gist.github.com/Keshava11/d14db1e22765e8de2670b8976f3c7efb



# 
# Radio Tranmission Reception Rig Setup


# Hardware

 
Raspberry Pi

2 meter transceiver

ground loop isolation transformer

USB Audio Capture Device

Note: The external speaker output from the 2 meter transceiver is connected to the USB audio capture device through an audio isolation transformer also known as a ground loop isolator.  If a Software-defined radio (SDR) is used in place of a transceiver the isolation transformer and USB audio capture device are unnecessary.

# 
# Software

 
Ubuntu Mate

Fldigi - digital modem program for hamradio operators

QSSTV (Version 9.2.6) - Qt based slow scan television and fax

Python 3

Icecast

DarkIce


# Ubuntu Mate on Raspberry Pi 3 software setup using ubuntu-mate-16.04.2-desktop-armhf-raspberry-pi.img

# Base applications installation


sudo apt-get install fldigi qsstv icecast2 darkice htop raspi-config chromium-browser gqrx-sdr


# Unrelated future project


sudo apt-get install gqrx-sdr


# Compile QSSTV 9.2.6 from source


sudo apt-get install g++ libfftw3-dev qt5-default libpulse-dev hamlib-dev libasound-dev  libv4l-dev libopenjp2-7 libopenjp2-7-dev

wget http://users.telenet.be/on4qz/qsstv/downloads/qsstv_9.2.6.tar.gz

tar -xvzf qsstv_9.2.6.tar.gz 

cd qsstv_9.2.6/

qmake

make


# Upgrade pip, pip3, and install dropbox


sudo pip install --upgrade pip

sudo pip3 install --upgrade pip

sudo pip3 install dropbox


# FireFox crashes on execution

# Install a specific version of FireFox

# Reference:  https://schwabencode.com/Blog/2018/07/15/Ubuntu-Mate-Firefox-Crash


sudo apt-get autoremove firefox

sudo apt-get install firefox=45.0.2+build1-0ubuntu1

sudo chmod 777 /home/livestream/

sudo chmod 777 /home/livestream/darkice.sh

sudo chmod 777 /home/livestream/dropboxbackup.py

sudo chmod 777 /home/livestream/greenhousesendrttyemail.py

sudo chmod 777 /home/livestream/greenhousesendsstvemail.py


# Support and configuration file name and locations


/home/livestream/darkice.cfg

/home/livestream/darkice.sh

/home/livestream/dropboxbackup.py

/home/livestream/greenhousesendrttyemail.py

/home/livestream/greenhousesendsstvemail.py

/home/livestream/lastepoch.txt

/home/livestream/lastimagedropbox.txt

/home/livestream/lastimg.txt

/home/livestream/lasttextoutdropbox.txt

/home/livestream/qsstv_9.2.6/

/home/livestream/.config/ON4QZ/qsstv_9.0.conf

/home/livestream/.fldigi/fldigi.prefs


# Configure cron


sudo crontab -e

7 */4 * * * reboot


crontab -e

@reboot sleep 10 && /home/livestream/darkice.sh

\# Check for a new SSTV image and send it via email/sms every five minutes (at every fifth minute)

\#*/5 * * * * /usr/bin/python3 /home/livestream/greenhousesendsstvemail.py

\# Check for a new SSTV image and send it via email/sms every twelve hours (zero past every twelfth hour)

0 */12 * * * /usr/bin/python3 /home/livestream/greenhousesendsstvemail.py

\# Check for a new RTTY status and send it via email/sms every two hours (zero past every second hour)

\#0 */2 * * * /usr/bin/python3 /home/livestream/greenhousesendrttyemail.py

\# Check for a new RTTY status and send it via email/sms every twelve hours (zero past every twelfth hour)

0 */12 * * * /usr/bin/python3 /home/livestream/greenhousesendrttyemail.py

\# Check for a new SSTV image and send it to a DropBox account every five minutes (at every fifth minute)

*/5 * * * * /usr/bin/python3 /home/livestream/dropboxbackup.py

\# Check for a new RTTY status and if the soil moisture value is too high or the temperature is too high or too low send a message via email/sms every two hours (at minute zero past every second hour)

0 */2 * * * /usr/bin/python3 /home/livestream/greenhousesendrttyemailalarm.py


# Execute Fldigi at GUI login


/home/livestream/.config/autostart/fldigi.desktop

[Desktop Entry]

Type=Application

Exec=/usr/bin/fldigi

Hidden=false

X-MATE-Autostart-enabled=true

Name[en_US]=fld.txt

Name=Fldigi

Comment[en_US]=Execute Fldigi at GUI login

Comment=Execute Fldigi at GUI login


# Execute QSSTV at GUI login


/home/livestream/.config/autostart/qsstv.desktop

[Desktop Entry]

Type=Application

Exec=/home/livestream/qsstv_9.2.6/qsstv/qsstv

Hidden=false

X-MATE-Autostart-enabled=true

Name[en_US]=QSSTV

Name=QSSTV

Comment[en_US]=Execute QSSTV at GUI login

Comment=Execute QSSTV at GUI login




